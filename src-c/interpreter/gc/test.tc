#include "gc.h"
#include "stdio.h"
#include "stdlib.h"

void deleteValue(void *obj)
{
    free(obj);
}

void deleteInc(void *obj)
{
    int *n = obj;
    *n += 1;
}

int main()
{
    CEGC_initialize();

    int *p1 = malloc(sizeof(int));
    CEGC_add(p1, &deleteValue);

    int n = 4;
    int *p2 = &n;
    CEGC_add(p2, &deleteInc);

    CEGC_deleteAllAndFinalize();

    printf("%d\n", n);

    return 0;
}