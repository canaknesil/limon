#include "newValue.h"
#include "IntVal.h"
#include "BoolVal.h"
#include "ProcVal.h"

#include <stdio.h>

void testIntVal()
{
	void *val1 = IntVal_FromString("12");
	void *val2 = IntVal_FromString("4");
	
	void *sum = IntVal_Add(val1, val2);
	
	printValue(val1);
	printValue(val2);
	printValue(sum);
	
	if (checkValueType(IntVal, sum)) printf("YES\n");

	deleteValue(val1);
	deleteValue(val2);
	deleteValue(sum);
}


void testBoolVal()
{
	void *b1 = newValue(BoolVal, TRUE);
	void *b2 = newValue(BoolVal, FALSE);
	void *b3 = BoolVal_And(b1, b2);
	
	printValue(b1);
	printValue(b2);
	printValue(b3);
	
	deleteValue(b1);
	deleteValue(b2);
	deleteValue(b3);
}

void testProcVal()
{
	int body = 1;
	int env = 2;
	void *proc = newValue(ProcVal, "x", &body, &env);
	
	printValue(proc);
	printf("%s\n", (char *) ProcVal_GetBVar(proc));
	printf("%d\n", *(int *) ProcVal_GetBody(proc));
	printf("%d\n", *(int *) ProcVal_GetEnv(proc));
	
	deleteValue(proc);
}

int main()
{
	testIntVal();
	testBoolVal();	
	testProcVal();

	return 0;
}
